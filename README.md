# Symbolic Regression with Neural Networks

This repository contains code for combining neural networks with symbolic regression to derive interpretable equations from complex regression data. The project workflow involves training a neural network on a regression problem and then leveraging the neural networkâ€™s predictions as input to a symbolic regression library to discover an underlying mathematical expression.

## Overview

### Purpose
The primary goal of this project is to enable **symbolic regression** using **neural networks**. This approach allows the model to first learn a complex relationship between input features and output targets through a neural network and then use symbolic regression to approximate this relationship with a simplified mathematical formula.

### Methodology
1. **Neural Network Training**: 
   - A neural network is trained on a specified regression problem, learning the input-output relationship from the provided data.
2. **Generating Input-Output Pairs**:
   - Once trained, the neural network is queried with a large number of inputs to generate corresponding output predictions.
3. **Symbolic Regression**:
   - These input-output pairs are then fed into the [gplearn](https://gplearn.readthedocs.io/) symbolic regression library.
   - Using genetic programming, gplearn attempts to fit a mathematical expression to the data generated by the neural network, aiming to reveal an interpretable formula that captures the underlying data pattern.

### Key Libraries
- **PyTorch**: for neural network training and inference.
- **gplearn**: a genetic programming library for symbolic regression.

## Repository Structure
- `models`: Contains the nonlinear and CNN models.
- `mgopt_methods`: Contains the MGDrop and SMGDrop optimization algorithms. 
- `experiments/`: Scripts for running the experiments and generating the results found in the thesis. Each subfolder is a unique experiment.
- `datasets`: Contains methods for loading and preprocessing the datasets used in the experiments.

## Requirements
The code requires Python with the following libraries:
- `torch` (for neural network training)
- `gplearn` (for symbolic regression)


